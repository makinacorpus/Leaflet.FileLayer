<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Leaflet Filelayer</title>
    <link href="./assets/images/file.png" rel="icon" type="image/x-icon" />
    <!-- 图标库 -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <style>
      .icon {
        max-width: 70%;
        max-height: 70%;
        margin: 4px;
      }
    </style>
    <link href="css/leafletFile.css" rel="stylesheet" />
  </head>
  <body>
    <div id="map" style="width: 100vw; height: 100vh"></div>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://unpkg.com/togeojson@0.16.0"></script>
    <script defer src="leaflet.filelayer.js"></script>
  </body>
  <script>
    (function (window) {
      'use strict';

      function initMap() {
        var control;
        var L = window.L;
        var map = L.map('map').setView([51.505, 1], 6);
        L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 19,
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        }).addTo(map);
        L.circle([51.505, 1], 500000, {
          color: 'red',
          fillColor: '#f03',
          fillOpacity: 0.5,
        }).addTo(map);
        L.circle([55, 5], 50000, {
          color: 'green',
          fillColor: 'darkgreen',
          fillOpacity: 0.8,
        }).addTo(map);

        var style = {
          color: 'red',
          opacity: 1.0,
          fillOpacity: 1.0,
          weight: 2,
          clickable: false,
        };
        control = L.Control.fileLayerLoad({
          fitBounds: true,
          layerOptions: {
            style: style,
            pointToLayer: function (data, latlng) {
              return L.circleMarker(latlng, { style: style });
            },
          },
        });
        control.addTo(map);
        control.loader.on('data:loaded', function (e) {
          var layer = e.layer;
          console.log(layer);
        });
      }

      window.addEventListener('load', function () {
        initMap();
      });
    })(window);
    // 在加载完文件后，将命名空间模块转换为全局变量

    /* var map = L.map('map').setView([51.505, 1], 6);
    L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
    }).addTo(map);
    L.circle([51.505, 1], 500000, {
      color: 'red',
      fillColor: '#f03',
      fillOpacity: 0.5,
    }).addTo(map);
    L.circle([55, 5], 50000, {
      color: 'green',
      fillColor: 'darkgreen',
      fillOpacity: 0.8,
    }).addTo(map);

    var style = {
      color: 'red',
      opacity: 1.0,
      fillOpacity: 1.0,
      weight: 2,
      clickable: false,
    };

    
    var control = L.Control.fileLayerLoad({
      fitBounds: true,
      layerOptions: {
        style: style,
        pointToLayer: function (data, latlng) {
          return L.circleMarker(latlng, { style: style });
        },
      },
    });

    control.addTo(map);
    control.loader.on('data:loaded', function (e) {
      var layer = e.layer;
      console.log(layer);
    }); */
  </script>
</html>
